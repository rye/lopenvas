CREATE extension IF NOT EXISTS "uuid-ossp";

CREATE role dba;
GRANT dba TO root;

UPDATE pg_language SET lanpltrusted = true WHERE lanname LIKE 'c';
GRANT USAGE ON LANGUAGE C TO root;

DROP FUNCTION IF EXISTS public.common_cve(text, text);
DROP FUNCTION IF EXISTS public.create_index(text, text, text);
DROP FUNCTION IF EXISTS public.create_index(text, text, text, text);
DROP FUNCTION IF EXISTS public.current_severity(real, text);
DROP FUNCTION IF EXISTS public.dynamic_severity();
DROP FUNCTION IF EXISTS public.group_concat_pair(text, text, text);
DROP FUNCTION IF EXISTS public.hosts_contains(text, text);
DROP FUNCTION IF EXISTS public.iso_time(integer);
DROP FUNCTION IF EXISTS public.level_max_severity(text, text);
DROP FUNCTION IF EXISTS public.level_min_severity(text, text);
DROP FUNCTION IF EXISTS public.lower(integer);
DROP FUNCTION IF EXISTS public.m_now();
DROP FUNCTION IF EXISTS public.make_uuid();
DROP FUNCTION IF EXISTS public.max_hosts(text, text);
DROP FUNCTION IF EXISTS public.next_time(integer, integer, integer);
DROP FUNCTION IF EXISTS public.now();
DROP FUNCTION IF EXISTS public.order_inet(text);
DROP FUNCTION IF EXISTS public.order_message_type(text);
DROP FUNCTION IF EXISTS public.order_port(text);
DROP FUNCTION IF EXISTS public.order_role(text);
DROP FUNCTION IF EXISTS public.order_threat(text);
DROP FUNCTION IF EXISTS public.report_active(integer);
DROP FUNCTION IF EXISTS public.report_host_count(integer);
DROP FUNCTION IF EXISTS public.report_progress(integer);
DROP FUNCTION IF EXISTS public.report_progress_active(integer);
DROP FUNCTION IF EXISTS public.report_result_host_count(integer, integer);
DROP FUNCTION IF EXISTS public.report_severity(integer, integer);
DROP FUNCTION IF EXISTS public.report_severity(integer, integer, integer);
DROP FUNCTION IF EXISTS public.report_severity_count(integer, integer, integer, text);
DROP FUNCTION IF EXISTS public.report_severity_count(integer, integer, text);
DROP FUNCTION IF EXISTS public.resource_name(text, text, integer);
DROP FUNCTION IF EXISTS public.run_status_name(integer);
DROP FUNCTION IF EXISTS public.severity_class();
DROP FUNCTION IF EXISTS public.severity_in_level(double precision, text);
DROP FUNCTION IF EXISTS public.severity_in_level(text, text);
DROP FUNCTION IF EXISTS public.severity_matches(double precision, double precision);
DROP FUNCTION IF EXISTS public.severity_matches_ov(double precision, double precision);
DROP FUNCTION IF EXISTS public.severity_to_level(double precision, integer);
DROP FUNCTION IF EXISTS public.severity_to_level(text, integer);
DROP FUNCTION IF EXISTS public.severity_to_type(double precision);
DROP FUNCTION IF EXISTS public.t();
DROP FUNCTION IF EXISTS public.tag(text, text);
DROP FUNCTION IF EXISTS public.task_last_report(integer);
DROP FUNCTION IF EXISTS public.task_second_last_report(integer);
DROP FUNCTION IF EXISTS public.task_severity(integer, integer);
DROP FUNCTION IF EXISTS public.task_severity(integer, integer, integer);
DROP FUNCTION IF EXISTS public.task_threat_level(integer, integer);
DROP FUNCTION IF EXISTS public.task_threat_level(integer, integer, integer);
DROP FUNCTION IF EXISTS public.task_trend(integer, integer);
DROP FUNCTION IF EXISTS public.task_trend(integer, integer, integer);
DROP FUNCTION IF EXISTS public.uniquify(text, text, integer, text);
DROP FUNCTION IF EXISTS public.user_can_everything(text);
DROP FUNCTION IF EXISTS public.user_has_super_on_resource(text, integer);
DROP FUNCTION IF EXISTS public.user_owns(text, integer);
DROP FUNCTION IF EXISTS public.valid_db_resource_type(text);

DROP AGGREGATE IF EXISTS public.group_concat (text, text);
DROP AGGREGATE IF EXISTS public.group_concat_pair (text, text, text);

DROP INDEX IF EXISTS public.nvt_cves_by_oid;
DROP INDEX IF EXISTS public.nvt_selectors_by_family_or_nvt;
DROP INDEX IF EXISTS public.nvt_selectors_by_name;
DROP INDEX IF EXISTS public.nvts_by_creation_time;
DROP INDEX IF EXISTS public.nvts_by_family;
DROP INDEX IF EXISTS public.nvts_by_name;
DROP INDEX IF EXISTS public.report_host_details_by_report_host_and_name_and_value;
DROP INDEX IF EXISTS public.report_hosts_by_report_and_host;
DROP INDEX IF EXISTS public.results_by_report;
